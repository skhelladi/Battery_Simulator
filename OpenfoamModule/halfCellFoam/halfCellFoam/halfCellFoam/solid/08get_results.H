
Info<<"enter 09get_results.H !"<<endl;

if(solidRegions[i].name() =="WE")
{
  // 1. Extract the averaged electrode potential fai_s at the boundary of WE_CC
  label ID_WE_CC                = solidRegions[i].boundaryMesh().findPatchID("WE_CC");
  scalarField fai_s_WE_CC_patch = fai_s.boundaryFieldRef()[ID_WE_CC];
  fai_s_WE_CC                   = average(fai_s_WE_CC_patch);

  // 2. Extract the current density at the WE_CC by fai_s: sum(k_fai_s*grad_fai_s*A_unit) = Iapp*cross_area
  volVectorField     fai_s_grad(fvc::grad(fai_s)); // calculate the gradient of fai_s over the whole domain
  volScalarField     fai_sX_grad               = fai_s_grad.component(vector::X); // the gradient component towards x direction
  scalarField        fai_s_WE_CC_gradValue     = fai_sX_grad.boundaryFieldRef()[ID_WE_CC];
  scalarField        k_fai_s_WE_CC             = k_fai_s.boundaryFieldRef()[ID_WE_CC];   // patch of k_fai_s at the WE_CC
  scalarField        A_WE_CC                   = mesh.magSf().boundaryField()[ID_WE_CC]; // patch of mesh area at the WE_CC
                     Iapp_WE_CC                = sum(k_fai_s_WE_CC * fai_s_WE_CC_gradValue * A_WE_CC) / sum(A_WE_CC); //calculate the current density at the WE_CC by fai_s

  // 3. Extract the current density by reaction rates in the WE: sum(i_current_int*A_unit) = Iapp*cross_area
  scalarField        V_WE    = mesh.V();           // patch of mesh volume in the WE
                     Iapp_WEReact = sum(J_current * V_WE) /  sum(A_WE_CC); //calculate the current density generated by WE reaction
                     theta_WE     = sum(theta * V_WE) / sum(V_WE);
                     Cs_WE        = sum(Cs * V_WE) / sum(V_WE);
                     C_se_WE      = sum(C_se * V_WE) / sum(V_WE);
                     Ce_WE        = sum(Ce * V_WE) / sum(V_WE);
                     U_rev_WE     = sum(U_rev * V_WE) / sum(V_WE);
                     fai_s_WE     = sum(fai_s * V_WE) / sum(V_WE);
                     fai_e_WE     = sum(fai_e * V_WE) / sum(V_WE);
                     eta_WE       = sum(eta * V_WE) / sum(V_WE);

Info<<"09get_results: Average reservable voltage in WE is" << U_rev_WE<<" V "<< endl;

}


if(solidRegions[i].name() =="sep")
{
  label ID_sep_RE = solidRegions[i].boundaryMesh().findPatchID("sep_RE");
  scalarField A_sep_RE = mesh.magSf().boundaryField()[ID_sep_RE]; // patch of mesh area at the sep_RE
  Iapp_REReact = sum(i_current_RE * A_sep_RE) /  sum(A_sep_RE); //calculate the current density generated by WE reaction
}

V             = fai_s_WE_CC;
net_J_current = Iapp_REReact + Iapp_WEReact + net_J_current;// i_current_RE represents the reaction rate in the RE, Iapp_WEReact represents the reaction rate in the WE
